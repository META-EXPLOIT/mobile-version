package br.com.metaexploit.diversight.ui.singup

import android.os.Bundle
import android.view.View
import android.widget.ImageView
import androidx.fragment.app.Fragment
import androidx.navigation.fragment.findNavController
import androidx.navigation.fragment.navArgs
import br.com.metaexploit.diversight.R
import com.google.android.material.button.MaterialButton
import com.google.android.material.textfield.TextInputLayout

class SingUpPart3Fragment : Fragment(R.layout.fragment_sing_up_part3) {

    private val args: SingUpPart3FragmentArgs by navArgs()

    private lateinit var backButton: ImageView
    private lateinit var email: TextInputLayout
    private lateinit var nextButton: MaterialButton

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        // Back button
        backButton = view.findViewById(R.id.fg_sing_up_3_button_back)
        backButton.setOnClickListener {
            findNavController().popBackStack()
        }

        email = view.findViewById(R.id.fg_sing_up_3_edt_email)

        // Next button
        nextButton = view.findViewById(R.id.fg_sing_up_3_btn_next)
        nextButton.setOnClickListener {
            nextPart()
        }
    }

    private fun nextPart() {
        findNavController().navigate(
            SingUpPart3FragmentDirections.actionSingUpPart3FragmentToSingUpPart4Fragment(
                args.name,
                args.skin,
                args.sex,
                args.gender,
                args.pcd,
                args.pcdVisual,
                args.pcdFisical,
                args.pcdHearing,
                args.pcdIntellectual,
                args.pcdPsychosocial,
                args.pcdReadapted,
                args.birthday,
                args.enterprise,
                args.occupation,
                args.office,
                email.editText?.text.toString().lowercase()
            )
        )
    }

//    override fun onPause() {
//        super.onPause()
//
//        val context = activity?.applicationContext
//
//        CoroutineScope(Dispatchers.IO).launch {
//            val db = context?.let {
//                Room.databaseBuilder(
//                    it,
//                    AppDatabase::class.java, "database"
//                ).build()
//            }
//
//            val user = db?.userDao()?.getRegisterUser(2)?.get(0)
//            db?.userDao()?.updateUser(
//                User(
//                    2,
//                    user?.name,
//                    user?.skin,
//                    user?.sex,
//                    user?.gender,
//                    user?.pcd,
//                    user?.pcdVisual,
//                    user?.pcdFisical,
//                    user?.pcdHearing,
//                    user?.pcdIntellectual,
//                    user?.pcdPsychosocial,
//                    user?.pcdReadapted,
//                    user?.birthday,
//                    user?.enterprise,
//                    user?.occupation,
//                    user?.office,
//                    email.editText?.text.toString(),
//                    null
//                )
//            )
//
//            Log.i("TESTE", "${db?.userDao()?.getRegisterUser(2)?.get(0)}")
//        }
//
//    }
}
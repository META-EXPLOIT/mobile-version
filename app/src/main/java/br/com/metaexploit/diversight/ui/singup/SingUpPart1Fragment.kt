package br.com.metaexploit.diversight.ui.singup

import android.os.Bundle
import android.view.View
import android.widget.ArrayAdapter
import android.widget.AutoCompleteTextView
import android.widget.LinearLayout
import androidx.appcompat.widget.AppCompatCheckBox
import androidx.fragment.app.Fragment
import androidx.lifecycle.ViewModelProvider
import br.com.metaexploit.diversight.R
import br.com.metaexploit.diversight.presenter.RegisterViewModel
import com.google.android.material.textfield.TextInputLayout

class SingUpPart1Fragment : Fragment(R.layout.fragment_sing_up_part1) {

    private lateinit var inputName: TextInputLayout

    private lateinit var inputSkin: TextInputLayout
    private lateinit var autoCompleteSkin: AutoCompleteTextView
    private var selectedSkin: Int = -1
    private val listSkin = listOf(
        "Branca",
        "Parda", "Preta",
        "Amarela",
        "Indígena"
    )

    private lateinit var inputSex: TextInputLayout
    private lateinit var autoCompleteSex: AutoCompleteTextView
    private var selectedSex: Int = -1
    private val listSex = listOf(
        "Cisgênero homem",
        "Cisgênero mulher",
        "Transgênero homem",
        "Transgênero mulher",
        "Agênero",
        "Não binário"
    )

    private lateinit var inputGender: TextInputLayout
    private lateinit var autoCompleteGender: AutoCompleteTextView
    private var selectedGender: Int = -1
    private val listGender = listOf(
        "Heterossexual",
        "Homossexual",
        "Bissexual",
        "Panssexual",
        "Assexual"
    )

    private lateinit var inputPcd: TextInputLayout
    private lateinit var autoCompletePcd: AutoCompleteTextView
    private var selectedPcd: Int = -1
    private val listPcd = listOf(
        "Sim",
        "Não"
    )

    private lateinit var optPcd: LinearLayout

    private lateinit var pcdOpt1: AppCompatCheckBox
    private lateinit var pcdOpt2: AppCompatCheckBox
    private lateinit var pcdOpt3: AppCompatCheckBox
    private lateinit var pcdOpt4: AppCompatCheckBox
    private lateinit var pcdOpt5: AppCompatCheckBox
    private lateinit var pcdOpt6: AppCompatCheckBox

    private lateinit var inputBirthday: TextInputLayout

    private lateinit var viewModel: RegisterViewModel

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        viewModel = ViewModelProvider(this).get(RegisterViewModel::class.java)

        // Name
        inputName = view.findViewById(R.id.fg_sing_up_1_edt_email)

        // Race
        inputSkin = view.findViewById(R.id.fg_sing_up_1_edt_enterprise)
        autoCompleteSkin = view.findViewById(R.id.fg_sing_up_1_edt_color_autocomplete)
        setAdapter(inputSkin, listSkin)
        autoCompleteSkin.setOnItemClickListener { parent, view, position, id ->
            selectedSkin = position
        }

        // Sex
        inputSex = view.findViewById(R.id.fg_sing_up_1_edt_sex)
        autoCompleteSex = view.findViewById(R.id.fg_sing_up_1_edt_sex_autocomplete)
        setAdapter(inputSex, listSex)
        autoCompleteSex.setOnItemClickListener { parent, view, position, id ->
            selectedSex = position
        }

        // Gender
        inputGender = view.findViewById(R.id.fg_sing_up_1_edt_gender)
        autoCompleteGender = view.findViewById(R.id.fg_sing_up_1_edt_gender_autocomplete)
        setAdapter(inputGender, listGender)
        autoCompleteGender.setOnItemClickListener { parent, view, position, id ->
            selectedGender = position
        }

        // PCD
        inputPcd = view.findViewById(R.id.fg_sing_up_1_edt_pcd)
        autoCompletePcd = view.findViewById(R.id.fg_sing_up_1_edt_pcd_autocomplete)
        optPcd = view.findViewById(R.id.fg_sing_up_1_pcd_opt)
        pcdOpt1 = view.findViewById(R.id.fg_sing_up_1_pcd_opt_1)
        pcdOpt2 = view.findViewById(R.id.fg_sing_up_1_pcd_opt_2)
        pcdOpt3 = view.findViewById(R.id.fg_sing_up_1_pcd_opt_3)
        pcdOpt4 = view.findViewById(R.id.fg_sing_up_1_pcd_opt_4)
        pcdOpt5 = view.findViewById(R.id.fg_sing_up_1_pcd_opt_5)
        pcdOpt6 = view.findViewById(R.id.fg_sing_up_1_pcd_opt_6)
        setAdapter(inputPcd, listPcd)
        autoCompletePcd.setOnItemClickListener { parent, view, position, id ->
            selectedPcd = position

            if (position == 0) {
                optPcd.visibility = View.VISIBLE
            } else {
                pcdOpt1.isChecked = false
                pcdOpt2.isChecked = false
                pcdOpt3.isChecked = false
                pcdOpt4.isChecked = false
                pcdOpt5.isChecked = false
                pcdOpt6.isChecked = false
                optPcd.visibility = View.GONE
            }
        }

        // Birthday
        inputBirthday = view.findViewById(R.id.fg_sing_up_1_edt_birthday)
    }

    private fun setAdapter(inputLayout: TextInputLayout, items: List<String>) {
        val adapter = ArrayAdapter(requireContext(), R.layout.list_item, items)
        (inputLayout.editText as? AutoCompleteTextView)?.setAdapter(adapter)
    }
}
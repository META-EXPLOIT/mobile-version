package br.com.metaexploit.diversight

import android.os.Bundle
import android.view.View
import android.widget.ProgressBar
import androidx.fragment.app.Fragment
import androidx.navigation.fragment.NavHostFragment
import br.com.metaexploit.diversight.singup.SingUpPart1FragmentDirections
import br.com.metaexploit.diversight.singup.SingUpPart2FragmentDirections
import br.com.metaexploit.diversight.singup.SingUpPart3FragmentDirections
import com.google.android.material.button.MaterialButton

class SingUpFragment : Fragment(R.layout.fragment_sing_up) {

    private lateinit var btnNext: MaterialButton
    private lateinit var progressBar: ProgressBar

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        btnNext = view.findViewById(R.id.sing_up_btn_next2)
        progressBar = view.findViewById(R.id.progressBarSingUp)

        val nav1 =
            (childFragmentManager.findFragmentById(R.id.fg_singup) as NavHostFragment).navController

        lateinit var navigationSingUpFragment: () -> Unit

        nav1.addOnDestinationChangedListener { controller, destination, arguments ->
            when (destination.label) {
                "fragment_sing_up_part1" -> {
                    navigationSingUpFragment = {
                        nav1.navigate(SingUpPart1FragmentDirections.actionSingUpPart1FragmentToSingUpPart2Fragment())
                        progressBar.progress = 38
                    }
                }
                "fragment_sing_up_part2" -> {
                    navigationSingUpFragment = {
                        nav1.navigate(SingUpPart2FragmentDirections.actionSingUpPart2FragmentToSingUpPart3Fragment())
                        progressBar.progress = 71
                    }
                }
                "fragment_sing_up_part3" -> {
                    navigationSingUpFragment = {
                        nav1.navigate(SingUpPart3FragmentDirections.actionSingUpPart3FragmentToSingUpPart4Fragment())
                        progressBar.progress = 100
                        btnNext.text = "Finalizar"
                    }
                }
                "fragment_sing_up_part4" -> {
                    navigationSingUpFragment = {
                        
                    }
                }
            }
        }

        btnNext.setOnClickListener {
            navigationSingUpFragment()
        }


    }
}
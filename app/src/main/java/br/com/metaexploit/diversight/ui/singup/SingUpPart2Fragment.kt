package br.com.metaexploit.diversight.ui.singup

import android.os.Bundle
import android.util.Log
import android.view.View
import android.widget.ArrayAdapter
import android.widget.AutoCompleteTextView
import androidx.fragment.app.Fragment
import androidx.lifecycle.ViewModelProvider
import br.com.metaexploit.diversight.R
import br.com.metaexploit.diversight.presenter.RegisterViewModel
import com.google.android.material.textfield.TextInputLayout

class SingUpPart2Fragment : Fragment(R.layout.fragment_sing_up_part2) {

    private lateinit var inputEnterprise: TextInputLayout
    private lateinit var autoCompleteEnterprise: AutoCompleteTextView
    private lateinit var selectedEnterprise: String
    private val listEnterprise = listOf(
        "Ioasys",
        "Havaianas",
        "Minuzo"
    )

    private lateinit var inputOccupation: TextInputLayout
    private lateinit var autoCompleteOccupation: AutoCompleteTextView
    private lateinit var selectedOccupation: String
    private val listOccupation = listOf(
        "Administrativo",
        "Atendimento ao cliente",
        "Comercial",
        "Data Science",
        "Desenvolvimento",
        "Financeiro",
        "Infraestrutura e Segurança de T.I.",
        "Inteligência de dados e Projetos",
        "Jurídico",
        "Localização e Tradução",
        "Marketing",
        "Produtos",
        "Recursos Humanos",
        "Riscos e compliance"
    )

    private lateinit var inputOffice: TextInputLayout
    private lateinit var autoCompleteOffice: AutoCompleteTextView
    private lateinit var selectedOffice: String
    private val listOffice = listOf(
        "Estágio",
        "Assistente",
        "Trainee",
        "Analista",
        "Gerente",
        "Coordenação",
        "Direção"
    )

    private lateinit var registerViewModel: RegisterViewModel

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        registerViewModel = ViewModelProvider(this).get(RegisterViewModel::class.java)
        Log.i("TESTE", registerViewModel.name.value.toString())

        // Enterprise
        inputEnterprise = view.findViewById(R.id.fg_sing_up_2_edt_enterprise)
        autoCompleteEnterprise = view.findViewById(R.id.fg_sing_up_2_edt_enterprise_autocomplete)
        setAdapter(inputEnterprise, listEnterprise)
        autoCompleteEnterprise.setOnItemClickListener { _, _, position, _ ->
            selectedEnterprise = listEnterprise[position]
        }

        // Occupation
        inputOccupation = view.findViewById(R.id.fg_sing_up_2_edt_occupation)
        autoCompleteOccupation = view.findViewById(R.id.fg_sing_up_2_edt_occupation_autocomplete)
        setAdapter(inputOccupation, listOccupation)
        autoCompleteOccupation.setOnItemClickListener { _, _, position, _ ->
            selectedOccupation = listOccupation[position]
        }

        // Office
        inputOffice = view.findViewById(R.id.fg_sing_up_2_edt_office)
        autoCompleteOffice = view.findViewById(R.id.fg_sing_up_2_edt_office_autocomplete)
        setAdapter(inputOffice, listOffice)
        autoCompleteOffice.setOnItemClickListener { _, _, position, _ ->
            selectedOffice = listOffice[position]
        }
    }

    private fun setAdapter(inputLayout: TextInputLayout, items: List<String>) {
        val adapter = ArrayAdapter(requireContext(), R.layout.list_item, items)
        (inputLayout.editText as? AutoCompleteTextView)?.setAdapter(adapter)
    }
}
package br.com.metaexploit.diversight.ui

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.fragment.app.Fragment
import androidx.navigation.fragment.findNavController
import androidx.navigation.fragment.navArgs
import br.com.metaexploit.diversight.R
import br.com.metaexploit.diversight.databinding.FragmentEmotionalBinding
import java.text.SimpleDateFormat
import java.util.*

class EmotionalFragment : Fragment() {

    private lateinit var binding: FragmentEmotionalBinding
    private val args: EmotionalFragmentArgs by navArgs()

    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View {
        binding = FragmentEmotionalBinding.inflate(inflater, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        // Status
        var statusEmoticonVerySad = false
        var statusEmoticonSad = false
        var statusEmoticonNeutral = false
        var statusEmoticonHappy = false
        var statusEmoticonVeryHappy = false

        // Selected emoticon
        var selectedEmotion = 0

        when (args.form.type) {
            // 0 - Daily
            "diaria" -> {
                binding.subtitle.text = getString(R.string.daily_subtitle)
                binding.enunciated.text = getString(R.string.daily_enunciated)
//                TODO("AQUI FICA A LISTA ENORME DOS COISA LÁ SEMANAL")
//                checklist.visibility = View.GONE
            }
            // else - Weekly
            else -> {
                binding.subtitle.text = getString(R.string.weekly_subtitle)
                binding.enunciated.text = getString(R.string.weekly_enunciated)
//                checklist.visibility = View.VISIBLE
            }
        }

        // Data
        val date = Calendar.getInstance().time
        val dateTimeFormat = SimpleDateFormat("dd/MM/yyyy", Locale.getDefault())

        binding.date.text = dateTimeFormat.format(date)

        // Very sad emoticon - 1
        binding.emVerySad.setOnClickListener {
            if (statusEmoticonVerySad) {
                selectedEmotion = 0

                statusEmoticonVerySad = false
                binding.imageEmVerySad.setBackgroundResource(R.drawable.ic_emoticon_very_sad_off)
            } else {
                selectedEmotion = 1

                statusEmoticonVerySad = true
                binding.imageEmVerySad.setBackgroundResource(R.drawable.ic_emoticon_very_sad_on)
                statusEmoticonSad = false
                binding.imageEmSad.setBackgroundResource(R.drawable.ic_emoticon_sad_off)
                statusEmoticonNeutral = false
                binding.imageEmNeutral.setBackgroundResource(R.drawable.ic_emoticon_neutral_off)
                statusEmoticonHappy = false
                binding.imageEmHappy.setBackgroundResource(R.drawable.ic_emoticon_happy_off)
                statusEmoticonVeryHappy = false
                binding.imageEmVeryHappy.setBackgroundResource(R.drawable.ic_emoticon_very_happy_off)
            }
        }
        // Sad emoticon - 2
        binding.emSad.setOnClickListener {
            if (statusEmoticonSad) {
                selectedEmotion = 0

                statusEmoticonSad = false
                binding.imageEmSad.setBackgroundResource(R.drawable.ic_emoticon_sad_off)
            } else {
                selectedEmotion = 2

                statusEmoticonVerySad = false
                binding.imageEmVerySad.setBackgroundResource(R.drawable.ic_emoticon_very_sad_off)
                statusEmoticonSad = true
                binding.imageEmSad.setBackgroundResource(R.drawable.ic_emoticon_sad_on)
                statusEmoticonNeutral = false
                binding.imageEmNeutral.setBackgroundResource(R.drawable.ic_emoticon_neutral_off)
                statusEmoticonHappy = false
                binding.imageEmHappy.setBackgroundResource(R.drawable.ic_emoticon_happy_off)
                statusEmoticonVeryHappy = false
                binding.imageEmVeryHappy.setBackgroundResource(R.drawable.ic_emoticon_very_happy_off)
            }
        }
        // Neutral emoticon - 3
        binding.emNeutral.setOnClickListener {
            if (statusEmoticonNeutral) {
                selectedEmotion = 0

                statusEmoticonNeutral = false
                binding.imageEmNeutral.setBackgroundResource(R.drawable.ic_emoticon_neutral_off)
            } else {
                selectedEmotion = 3

                statusEmoticonVerySad = false
                binding.imageEmVerySad.setBackgroundResource(R.drawable.ic_emoticon_very_sad_off)
                statusEmoticonSad = false
                binding.imageEmSad.setBackgroundResource(R.drawable.ic_emoticon_sad_off)
                statusEmoticonNeutral = true
                binding.imageEmNeutral.setBackgroundResource(R.drawable.ic_emoticon_neutral_on)
                statusEmoticonHappy = false
                binding.imageEmHappy.setBackgroundResource(R.drawable.ic_emoticon_happy_off)
                statusEmoticonVeryHappy = false
                binding.imageEmVeryHappy.setBackgroundResource(R.drawable.ic_emoticon_very_happy_off)
            }
        }
        // Happy emoticon - 4
        binding.emHappy.setOnClickListener {
            if (statusEmoticonHappy) {
                selectedEmotion = 0

                statusEmoticonHappy = false
                binding.imageEmHappy.setBackgroundResource(R.drawable.ic_emoticon_happy_off)
            } else {
                selectedEmotion = 4

                statusEmoticonVerySad = false
                binding.imageEmVerySad.setBackgroundResource(R.drawable.ic_emoticon_very_sad_off)
                statusEmoticonSad = false
                binding.imageEmSad.setBackgroundResource(R.drawable.ic_emoticon_sad_off)
                statusEmoticonNeutral = false
                binding.imageEmNeutral.setBackgroundResource(R.drawable.ic_emoticon_neutral_off)
                statusEmoticonHappy = true
                binding.imageEmHappy.setBackgroundResource(R.drawable.ic_emoticon_happy_on)
                statusEmoticonVeryHappy = false
                binding.imageEmVeryHappy.setBackgroundResource(R.drawable.ic_emoticon_very_happy_off)
            }
        }
        // Very happy emoticon - 5
        binding.emVeryHappy.setOnClickListener {
            if (statusEmoticonVeryHappy) {
                selectedEmotion = 0

                statusEmoticonVeryHappy = false
                binding.imageEmVeryHappy.setBackgroundResource(R.drawable.ic_emoticon_very_happy_off)
            } else {
                selectedEmotion = 5

                statusEmoticonVerySad = false
                binding.imageEmVerySad.setBackgroundResource(R.drawable.ic_emoticon_very_sad_off)
                statusEmoticonSad = false
                binding.imageEmSad.setBackgroundResource(R.drawable.ic_emoticon_sad_off)
                statusEmoticonNeutral = false
                binding.imageEmNeutral.setBackgroundResource(R.drawable.ic_emoticon_neutral_off)
                statusEmoticonHappy = false
                binding.imageEmHappy.setBackgroundResource(R.drawable.ic_emoticon_happy_off)
                statusEmoticonVeryHappy = true
                binding.imageEmVeryHappy.setBackgroundResource(R.drawable.ic_emoticon_very_happy_on)
            }
        }

        // Back button
        binding.btnBack.setOnClickListener {
            findNavController().popBackStack()
        }
        // Send button
        binding.btnSend.setOnClickListener {
            binding.date.visibility = View.GONE
            binding.enunciated.visibility = View.GONE
            binding.line.visibility = View.GONE
            binding.emoticonContainer.visibility = View.GONE

            binding.icComplete.visibility = View.VISIBLE
            binding.txtComplete.visibility = View.VISIBLE

            binding.btnSend.visibility = View.GONE
            binding.btnHome.visibility = View.VISIBLE
//            TODO("BAGULHO DAS SEMANAIS TAMBÉM")
//            checklist.visibility = View.GONE
        }
        // Home button
        binding.btnHome.setOnClickListener {
//            when (args.form.type) {
//                // 0 - Daily
//                "diaria" -> sendEmotionalDaily(selectedEmotion)
//                // else - Weekly
//                else -> sendEmotionalWeekly(selectedEmotion)
//            }

            findNavController().popBackStack()
        }
    }

//    private fun sendEmotionalDaily(selection: Int) {}
//
//    private fun sendEmotionalWeekly(selection: Int) {}
}
package br.com.metaexploit.diversight.ui

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ArrayAdapter
import android.widget.AutoCompleteTextView
import android.widget.Toast
import androidx.appcompat.widget.AppCompatImageView
import androidx.databinding.DataBindingUtil
import androidx.fragment.app.Fragment
import androidx.navigation.fragment.findNavController
import br.com.metaexploit.diversight.R
import br.com.metaexploit.diversight.databinding.FragmentUpdateEnterpriseBinding
import com.google.android.material.button.MaterialButton
import com.google.android.material.textfield.TextInputLayout

class UpdateEnterpriseFragment : Fragment() {

    private lateinit var binding: FragmentUpdateEnterpriseBinding

    private lateinit var selectedEnterprise: String
    private val listEnterprise = listOf(
        "Ioasys",
        "Havaianas",
        "Minuzo"
    )

    private lateinit var selectedOccupation: String
    private val listOccupation = listOf(
        "Administrativo",
        "Atendimento ao cliente",
        "Comercial",
        "Data Science",
        "Desenvolvimento",
        "Financeiro",
        "Infraestrutura e Segurança de T.I.",
        "Inteligência de dados e Projetos",
        "Jurídico",
        "Localização e Tradução",
        "Marketing",
        "Produtos",
        "Recursos Humanos",
        "Riscos e compliance"
    )

    private lateinit var selectedOffice: String
    private val listOffice = listOf(
        "Estágio",
        "Assistente",
        "Trainee",
        "Analista",
        "Gerente",
        "Coordenação",
        "Direção"
    )

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        binding = DataBindingUtil.inflate(inflater, R.layout.fragment_update_enterprise, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        // Back button
        binding.btnBack.setOnClickListener {
            findNavController().popBackStack()
        }

        // Enterprise
        setAdapter(binding.edtEnterprise, listEnterprise)
        binding.acEnterprise.setOnItemClickListener { _, _, position, _ ->
            selectedEnterprise = listEnterprise[position]
        }

        // Occupation
        setAdapter(binding.edtOccupation, listOccupation)
        binding.acOccupation.setOnItemClickListener { _, _, position, _ ->
            selectedOccupation = listOccupation[position]
        }

        // Office
        setAdapter(binding.edtOffice, listOffice)
        binding.acOffice.setOnItemClickListener { _, _, position, _ ->
            selectedOffice = listOffice[position]
        }

        binding.btnDone.setOnClickListener {
            Toast.makeText(context, "Dados atualizados!", Toast.LENGTH_SHORT).show()
            findNavController().popBackStack()
        }
    }

    private fun setAdapter(inputLayout: TextInputLayout, items: List<String>) {
        val adapter = ArrayAdapter(requireContext(), R.layout.list_item, items)
        (inputLayout.editText as? AutoCompleteTextView)?.setAdapter(adapter)
    }
}